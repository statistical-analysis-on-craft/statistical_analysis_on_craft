clear;
N = 2^21;
F=@(x,y)(exp(sqrt(x.*y)+sqrt(y-x.*y))+exp(sqrt(x.*y)-sqrt(y-x.*y))+exp(-sqrt(x.*y)+sqrt(y-x.*y))+exp(-sqrt(x.*y)-sqrt(y-x.*y))).*exp((-(N.^2).*2^(-35)-y)./(N*2^(-17)))./(N*2^(-15).*pi.*sqrt(x.*(1-x)));
P=1-(integral2(F,0,1,0,2^(-28.6)));
Q=1-(integral2(F,0,1,0,64));
O=1-(integral2(F,0,1,0,128));
R=1-(integral2(F,0,1,0,256));
fprintf('P = %d\n',P); 
fprintf('Q = %d\n',Q);
fprintf('O = %d\n',O);
fprintf('R = %d\n',R);